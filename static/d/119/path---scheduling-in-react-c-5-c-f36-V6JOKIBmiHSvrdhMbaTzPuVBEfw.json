{"data":{"site":{"siteMetadata":{"author":"Philipp Spiess"}},"markdownRemark":{"id":"790510e4-e8af-5ec2-9e57-cefd113a1d89","excerpt":"In modern applications, user interfaces often have to juggle multiple parts at the same time: A search component needs to respond to user input while providing…","html":"<p>In modern applications, user interfaces often have to juggle multiple parts at the same time: A search component needs to respond to user input while providing auto completion results; An interactive dashboard needs to update the charts while loading data from the server and sending analytics data to your backend.</p>\n<p>All these parallel steps can lead to janky interfaces and unhappy users – Let’s learn how we can fix this.</p>\n<h2>Scheduling in User Interfaces</h2>\n<h3>Some Problems in UIs</h3>\n<p>Before we dive deeper, I want to highlight two problems that most user interfaces have to deal with:</p>\n<ol>\n<li><strong>Users expect immediate feedback.</strong> Wether a user is clicking on a button or adding text to an input field, they expect some kind of confirmation immediately. The button might show a modal, the input field will display the key that was typed.</li>\n<li><strong>Interactions can happen at any time.</strong> Since we all can’t predict the future, we don’t know if a user will click a button in 10 milliseconds or in 5 seconds. In order to react to interactions as soon as possible, we need to stay responsive to browser events.</li>\n</ol>\n<p>To visualize the problems, let’s take a look at the demo application that Dan Abramov showed us at his talk <a href=\"https://reactjs.org/blog/2018/03/01/sneak-peek-beyond-react-16.html\">Beyond React 16</a> at JSConf Iceland 2018. The more you type into the input box above, the more detailed the charts below will get. Since both of those updates run at the same time, the input feels janky.</p>\n<p><video src=\"/blog/scheduling-in-react/sync-mode.mp4\" muted=\"true\" autoplay loop></video></p>\n<p>One thing that we can see in the example above is that it’s more important to update the text box with the user input than it is to update the carts. A version that prioritizes that will appear a lot more responsive to the end user.</p>\n<p><video src=\"/blog/scheduling-in-react/concurrent-mode.mp4\" muted=\"true\" autoplay loop></video></p>\n<p>Unfortunately, current user interface architectures makes it non trivial to implement this kind of prioritization. One way to solve this is by <a href=\"https://davidwalsh.name/javascript-debounce-function\">debouncing</a> the chart update. The problem with this is that the charts still render in one go synchronously when the debounced callback fires, which will again cause our user interface to take multiple seconds during which it is not responsive. We can do better!</p>\n<h3>Browser Event Loop</h3>\n<p>Before we learn more about concrete solutions, let’s dig deeper and understand why the browser has issues these kind of user interfaces.</p>\n<p>Most JavaScript code is executed on the same thread that is also responsible for other document lifecycles like layout and paint<sup id=\"fnref-1\"><a href=\"#fn-1\" class=\"footnote-ref\">1</a></sup>. This means that whenever your JavaScript code runs, the browser is blocked form doing anything else.</p>\n<p><img src=\"browser-event-loop.png\"></p>\n<p>a</p>\n<p>a</p>\n<p>a</p>\n<p>a</p>\n<p>a</p>\n<p>a</p>\n<p>a</p>\n<p>a</p>\n<p>a</p>\n<p>a</p>\n<p>a</p>\n<p>a</p>\n<p>a</p>\n<p>a</p>\n<h2>Concurrent React and the Scheduler</h2>\n<h2></h2>\n<div class=\"footnotes\">\n<hr>\n<ol>\n<li id=\"fn-1\">\n<p>The MDN web docs feature a great <a href=\"https://developer.mozilla.org/en-US/docs/Tools/Performance/Scenarios/Intensive_JavaScript\">article</a> about this issue.</p>\n<a href=\"#fnref-1\" class=\"footnote-backref\">↩</a>\n</li>\n</ol>\n</div>","frontmatter":{"title":"Scheduling in React","date":"March 15, 2019"}}},"pageContext":{"slug":"/scheduling-in-react/","previous":null,"next":{"fields":{"slug":"/react-mental-model/"},"frontmatter":{"title":"The Mental Model of React","external":null}}}}